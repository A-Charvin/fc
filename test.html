<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="UTF-8">

    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2025 Frontenac Business Plans and Project Proposals</title>

    <script src="https://cdn.tailwindcss.com"></script>


    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Poppins:wght@600;700&display=swap"
        rel="stylesheet">

    <style>
        /* Apply Inter as the default font */
        body {
            font-family: 'Inter', sans-serif;
            background-image: url('./background.jpg');
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            /* Use a dark color for all body text by default */
            color: #212529;
            /* Near-black for maximum contrast */
        }

        h1,
        h2,
        .tab {
            font-family: 'Poppins', sans-serif;
        }

        main {
            padding: 1.5rem;
            box-sizing: border-box;
            overflow: hidden;
            flex-grow: 1;
        }

        @media (min-width: 768px) {
            main {
                height: calc(100vh - 4rem - 2.5rem - 3.5rem);
                min-height: 50vh;
            }
        }


        @media (max-width: 767px) {
            #content-box {
                max-height: 80vh;
            }
        }

        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: #f4f6f3;
        }

        ::-webkit-scrollbar-thumb {
            /* Changed scrollbar thumb to a darker color for better visibility */
            background: #5a7761;
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #4a5d4f;
        }

        #iframe-panel-wrapper {
            display: flex;
            flex-direction: column;
            flex-grow: 1;
            height: 100%;
        }

        #pdf-viewer {
            width: 100%;
            height: 100%;
            min-height: 50vh;
        }

        .tab.active {
            /* Darkened active tab BG for better contrast with white text */
            background-color: #3f704d;
            box-shadow: 0 0 0 2px #2e593c;
            /* Darker accent border */
        }

        .sidebar-link {
            display: block;
            padding: 1px 0;
            /* Used the darker text color for links for high contrast */
            color: #2e593c;
            font-weight: 600;
            /* Increased weight for better readability */
            transition: color 150ms;
        }

        .sidebar-link:hover {
            /* Darker hover color */
            color: #3f704d;
            text-decoration: underline;
        }
    </style>

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        // Adjusted colors for better contrast ðŸŽ¨
                        'frontenac-dark': '#3a4a3e', // Header, Footer BG (Slightly darker for better contrast with any lighter text)
                        'frontenac-mid': '#5a7761', // Nav BG
                        'frontenac-light': '#8fa895', // Tab BG (Used only for background, the text on this should be the darker text color)
                        'frontenac-hover': '#6a8c70', // Tab Hover / Active (Darker)
                        'frontenac-text': '#212529', // Main Text Color (Near-black for high contrast on light backgrounds)
                        'frontenac-accent': '#2e593c', // Link Color (Darker, strong contrast on light backgrounds)
                    }
                }
            }
        }
    </script>
</head>

<body class="flex flex-col min-h-screen">

    <div class="bg-frontenac-dark shadow-lg">
        <header class="p-4 flex justify-between items-center text-white">
            <h1 class="text-lg md:text-xl font-bold m-0 text-center flex-grow md:flex-grow-0">2025 Frontenac Business
                Plans and Project Proposals</h1>
            <a href="https://www.frontenaccounty.ca/en/index.aspx" target="_blank" rel="noopener noreferrer">
                <img src="https://www.arcgis.com/sharing/rest/content/items/1fb19e3554e4435db3beaf9aba7d35f0/resources/sm_series_logo__1729256084564.png"
                    alt="Frontenac Logo"
                    class="h-10 w-auto rounded-md opacity-90 hover:opacity-100 transition duration-300 ml-4">
            </a>
        </header>

        <div class="bg-frontenac-mid p-1.5 shadow-inner">
            <nav id="full-nav" class="hidden md:flex flex-wrap gap-2"></nav>

            <nav id="mobile-nav" class="flex justify-center md:hidden">
                <button id="prev-tab" title="Previous Department"
                    class="text-white hover:text-frontenac-hover transition duration-300 p-1">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                        xmlns="http://www.w3.org/2000/svg">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7">
                        </path>
                    </svg>
                </button>
                <div id="current-tab-name"
                    class="tab px-4 py-1.5 rounded-lg text-white font-semibold flex items-center justify-center min-w-[150px] bg-frontenac-hover mx-2">
                    Intro
                </div>
                <button id="next-tab" title="Next Department"
                    class="text-white hover:text-frontenac-hover transition duration-300 p-1">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                        xmlns="http://www.w3.org/2000/svg">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7">
                        </path>
                    </svg>
                </button>
            </nav>
        </div>
    </div>

    <main class="flex-grow">
        <div id="main-container"
            class="flex flex-col md:flex-row md:space-x-6 space-y-3 md:space-y-0 w-full h-full items-start md:items-stretch">

            <div id="content-box"
                class="bg-white/90 p-4 md:p-6 rounded-xl shadow-xl w-full md:w-80 lg:w-96 text-frontenac-text self-start backdrop-blur-sm overflow-y-auto hidden md:block">

                <div class="flex justify-between items-start mb-3">
                    <h2 id="sidebar-title" class="text-xl md:text-2xl font-bold text-frontenac-dark pr-4">Welcome</h2>
                    <button id="hide-sidebar-btn" title="Hide Content"
                        class="md:hidden text-frontenac-accent hover:text-frontenac-dark p-1 rounded-full">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                            xmlns="http://www.w3.org/2000/svg">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M6 18L18 6M6 6l12 12"></path>
                        </svg>
                    </button>
                </div>

                <div id="sidebar-content" class="space-y-3 text-sm md:text-base">
                </div>
            </div>

            <div id="iframe-panel-wrapper"
                class="bg-white/90 p-1.5 rounded-xl shadow-2xl overflow-hidden w-full h-full flex-grow">

                <div id="button-row" class="mb-2 flex justify-between items-center">

                    <div id="back-button-container" class="flex items-center space-x-2 hidden">
                        <button id="back-button" title="Go back to the main department plan PDF"
                            class="flex items-center space-x-1 bg-frontenac-accent hover:bg-frontenac-dark text-white font-semibold py-2 px-4 rounded-lg transition duration-300 shadow-md text-sm">
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                                xmlns="http://www.w3.org/2000/svg">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M10 19l-7-7m0 0l7-7m-7 7h18"></path>
                            </svg>
                            <span>Back</span>
                        </button>
                    </div>

                    <button id="show-sidebar-btn" title="Show Content"
                        class="hidden md:hidden ml-4 text-frontenac-accent hover:text-frontenac-dark bg-white/50 p-2 rounded-lg">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                            xmlns="http://www.w3.org/2000/svg">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M4 6h16M4 12h16M4 18h16"></path>
                        </svg>
                    </button>
                </div>

                <div class="h-full">
                    <iframe id="pdf-viewer" src="" class="rounded-lg border-2 border-gray-200 w-full h-full"
                        allowfullscreen>
                    </iframe>
                </div>
            </div>
        </div>
    </main>

    <footer class="text-center p-4 bg-frontenac-dark text-white text-xs md:text-sm mt-auto">
        &copy; 2025 Frontenac County | Business Plans & Project Proposals
    </footer>

    <script>
        // --- Configuration ---
        const MOBILE_BREAKPOINT = 768; // Matches Tailwind's 'md' breakpoint

        // --- Application State Management ---
        const appState = {
            currentDepartment: 'Intro',
            currentIndex: 0,
            mainPdfUrl: '',
            backButtonVisible: false,
        };

        // --- Data Structure for all departments ---
        const departmentData = {
            'Intro': {
                title: "Welcome to the 2025 Plans",
                pdfUrl: "https://maps.frontenacgis.ca/business%20Plans/2025/2025_Draft_Budget.pdf",
                sidebarContentHtml: `
                        <p class="mb-4">Welcome to the Frontenac business plan and project proposal viewer. Each department is represented by a tab across the top. By selecting a tab you will be taken to the business plan associated with that department. There are also additional related resources and documents on each tab that can be viewed by clicking the links in the left menu.</p>
                        
                        <h3 class="font-bold mt-6 text-frontenac-dark">Main Documents:</h3>
                        <a href="https://maps.frontenacgis.ca/business%20Plans/2025/2025_Draft_Budget.pdf" class="js-pdf-link sidebar-link" data-pdf-url="https://maps.frontenacgis.ca/business%20Plans/2025/2025_Draft_Budget.pdf">2025 Draft Budget</a>
                        <a href="https://maps.frontenacgis.ca/business%20Plans/2025/BudgetPolicy.pdf" class="js-pdf-link sidebar-link" data-pdf-url="https://maps.frontenacgis.ca/business%20Plans/2025/BudgetPolicy.pdf">Budget Policy</a>
                        
                        <h3 class="font-bold mt-6 text-frontenac-dark">Other Resources:</h3>
                        <a href="https://www.frontenaccounty.ca/en/government/budgets.aspx" target="_blank" rel="noopener noreferrer" class="sidebar-link">Other Years (Website)</a>
                    `
            },
            'GIS': {
                title: "Geographic Information Systems (GIS)",
                pdfUrl: "https://maps.frontenacgis.ca/business%20Plans/2025/PPT/GIS.pdf",
                sidebarContentHtml: `
                        <h3 class="font-bold mt-1 text-frontenac-dark">Business Plan:</h3>
                        <a href="https://maps.frontenacgis.ca/business%20Plans/2025/PPT/GIS.pdf" class="js-pdf-link sidebar-link" data-pdf-url="https://maps.frontenacgis.ca/business%20Plans/2025/PPT/GIS.pdf">Business Plan (Presentation)</a>
                        <a href="https://maps.frontenacgis.ca/business%20Plans/2025/Word/GIS.pdf" class="js-pdf-link sidebar-link" data-pdf-url="https://maps.frontenacgis.ca/business%20Plans/2025/Word/GIS.pdf">Business Plan (Document)</a>
                        
                        <h3 class="font-bold mt-6 text-frontenac-dark">Resources:</h3>
                        <a href="https://www.frontenacmaps.ca/" target="_blank" rel="noopener noreferrer" class="sidebar-link">Frontenac Maps (GeoHub)</a>
                        <a href="https://www.frontenaccounty.ca/en/living/maps-and-gis.aspx" target="_blank" rel="noopener noreferrer" class="sidebar-link">Maps and GIS (Website)</a>
                    `
            },
            'Fairmount Home': {
                title: "Fairmount Home",
                pdfUrl: "https://maps.frontenacgis.ca/business%20Plans/2025/PPT/FMT.pdf",
                sidebarContentHtml: `
                        <h3 class="font-bold mt-1 text-frontenac-dark">Business Plan:</h3>
                        <a href="https://maps.frontenacgis.ca/business%20Plans/2025/PPT/FMT.pdf" class="js-pdf-link sidebar-link" data-pdf-url="https://maps.frontenacgis.ca/business%20Plans/2025/PPT/FMT.pdf">Business Plan (Presentation)</a>
                        <a href="https://maps.frontenacgis.ca/business%20Plans/2025/Word/FMT.pdf" class="js-pdf-link sidebar-link" data-pdf-url="https://maps.frontenacgis.ca/business%20Plans/2025/Word/FMT.pdf">Business Plan (Document)</a>
                        
                        <h3 class="font-bold mt-6 text-frontenac-dark">Project Proposal:</h3>
                        <a href="https://maps.frontenacgis.ca/business%20Plans/2025/PPT/Proposal-OccupationalTherapist.pdf" class="js-pdf-link sidebar-link" data-pdf-url="https://maps.frontenacgis.ca/business%20Plans/2025/PPT/Proposal-OccupationalTherapist.pdf">Occupational Therapist (Full-Time)</a>
                        
                        <h3 class="font-bold mt-6 text-frontenac-dark">Resources:</h3>
                        <a href="https://www.frontenaccounty.ca/en/fairmounthome/index.aspx" target="_blank" rel="noopener noreferrer" class="sidebar-link">Fairmount Home (Website)</a>
                    `
            },
            'Financial Services': {
                title: "Financial Services",
                pdfUrl: "https://maps.frontenacgis.ca/business%20Plans/2025/PPT/Finance.pdf",
                sidebarContentHtml: `
                        <h3 class="font-bold mt-1 text-frontenac-dark">Business Plan:</h3>
                        <a href="https://maps.frontenacgis.ca/business%20Plans/2025/PPT/Finance.pdf" class="js-pdf-link sidebar-link" data-pdf-url="https://maps.frontenacgis.ca/business%20Plans/2025/PPT/Finance.pdf">Business Plan (Presentation)</a>
                        <a href="https://maps.frontenacgis.ca/business%20Plans/2025/Word/Finance.pdf" class="js-pdf-link sidebar-link" data-pdf-url="https://maps.frontenacgis.ca/business%20Plans/2025/Word/Finance.pdf">Business Plan (Document)</a>
                        
                        <h3 class="font-bold mt-6 text-frontenac-dark">Resources:</h3>
                        <a href="https://www.frontenaccounty.ca/en/government/finances-and-budget.aspx" target="_blank" rel="noopener noreferrer" class="sidebar-link">Finance and Budgets (Website)</a>
                    `
            },
            'Information Services': {
                title: "Information Services",
                pdfUrl: "https://maps.frontenacgis.ca/business%20Plans/2025/PPT/FMIS.pdf",
                sidebarContentHtml: `
                        <h3 class="font-bold mt-1 text-frontenac-dark">Business Plan:</h3>
                        <a href="https://maps.frontenacgis.ca/business%20Plans/2025/PPT/FMIS.pdf" class="js-pdf-link sidebar-link" data-pdf-url="https://maps.frontenacgis.ca/business%20Plans/2025/PPT/FMIS.pdf">Business Plan (Presentation)</a>
                        <a href="https://maps.frontenacgis.ca/business%20Plans/2025/Word/FMIS.pdf" class="js-pdf-link sidebar-link" data-pdf-url="https://maps.frontenacgis.ca/business%20Plans/2025/Word/FMIS.pdf">Business Plan (Document)</a>
                    `
            },
            'Frontenac Paramedics': {
                title: "Frontenac Paramedic Services",
                pdfUrl: "https://maps.frontenacgis.ca/business%20Plans/2025/PPT/FPS.pdf",
                sidebarContentHtml: `
                        <h3 class="font-bold mt-1 text-frontenac-dark">Business Plan:</h3>
                        <a href="https://maps.frontenacgis.ca/business%20Plans/2025/PPT/FPS.pdf" class="js-pdf-link sidebar-link" data-pdf-url="https://maps.frontenacgis.ca/business%20Plans/2025/PPT/FPS.pdf">Business Plan (Presentation)</a>
                        <a href="https://maps.frontenacgis.ca/business%20Plans/2025/Word/FPS.pdf" class="js-pdf-link sidebar-link" data-pdf-url="https://maps.frontenacgis.ca/business%20Plans/2025/Word/FPS.pdf">Business Plan (Document)</a>
                        
                        <h3 class="font-bold mt-6 text-frontenac-dark">Project Proposals:</h3>
                        <a href="https://maps.frontenacgis.ca/business%20Plans/2025/PPT/FPS-EPRProposal.pdf" class="js-pdf-link sidebar-link" data-pdf-url="https://maps.frontenacgis.ca/business%20Plans/2025/PPT/FPS-EPRProposal.pdf">Enhanced Paramedic Resource</a>
                        <a href="https://maps.frontenacgis.ca/business%20Plans/2025/PPT/FPS-SPSProposal.pdf" class="js-pdf-link sidebar-link" data-pdf-url="https://maps.frontenacgis.ca/business%20Plans/2025/PPT/FPS-SPSProposal.pdf">Superintendent of Performance Standards, Training</a>
                        
                        <h3 class="font-bold mt-6 text-frontenac-dark">Resources:</h3>
                        <a href="https://www.frontenaccounty.ca/en/paramedics/index.aspx" target="_blank" rel="noopener noreferrer" class="sidebar-link">Frontenac Paramedic Services (Website)</a>
                        <a href="https://frontenac.maps.arcgis.com/apps/MapSeries/index.html?appid=1fb19e3554e4435db3beaf9aba7d35f0#" target="_blank" rel="noopener noreferrer" class="sidebar-link">Paramedic Stations (Map)</a>
                        <a href="https://maps.frontenacgis.ca/business%20Plans/2025/ORH_Study.pdf" class="js-pdf-link sidebar-link" data-pdf-url="https://maps.frontenacgis.ca/business%20Plans/2025/ORH_Study.pdf">ORH - 10-Year HR and Facilities Master Plan</a>
                        <a href="https://maps.frontenacgis.ca/business%20Plans/2025/EOWC_Study.pdf" class="js-pdf-link sidebar-link" data-pdf-url="https://maps.frontenacgis.ca/business%20Plans/2025/EOWC_Study.pdf">EOWC - Review of E Ontario Paramedic Services</a>
                        <a href="https://maps.frontenacgis.ca/business%20Plans/2025/EOWC_Paramedic_Services_Partial_Refresh.pdf" class="js-pdf-link sidebar-link" data-pdf-url="https://maps.frontenacgis.ca/business%20Plans/2025/EOWC_Paramedic_Services_Partial_Refresh.pdf">EOWC - Paramedic Services Partial Refresh</a>
                    `
            },
            'Human Resources': {
                title: "Human Resources (HR)",
                pdfUrl: "https://maps.frontenacgis.ca/business%20Plans/2025/PPT/HR.pdf",
                sidebarContentHtml: `
                        <h3 class="font-bold mt-1 text-frontenac-dark">Business Plan:</h3>
                        <a href="https://maps.frontenacgis.ca/business%20Plans/2025/PPT/HR.pdf" class="js-pdf-link sidebar-link" data-pdf-url="https://maps.frontenacgis.ca/business%20Plans/2025/PPT/HR.pdf">Business Plan (Presentation)</a>
                        <a href="https://maps.frontenacgis.ca/business%20Plans/2025/Word/HR.pdf" class="js-pdf-link sidebar-link" data-pdf-url="https://maps.frontenacgis.ca/business%20Plans/2025/Word/HR.pdf">Business Plan (Document)</a>
                        
                        <h3 class="font-bold mt-6 text-frontenac-dark">Resources:</h3>
                        <a href="https://www.frontenaccounty.ca/en/government/careers.aspx" target="_blank" rel="noopener noreferrer" class="sidebar-link">Careers (Website)</a>
                    `
            },
            'Legislative Services': {
                title: "Legislative Services",
                pdfUrl: "https://maps.frontenacgis.ca/business%20Plans/2025/PPT/LegislativeServices.pdf",
                sidebarContentHtml: `
                        <h3 class="font-bold mt-1 text-frontenac-dark">Business Plan:</h3>
                        <a href="https://maps.frontenacgis.ca/business%20Plans/2025/PPT/LegislativeServices.pdf" class="js-pdf-link sidebar-link" data-pdf-url="https://maps.frontenacgis.ca/business%20Plans/2025/PPT/LegislativeServices.pdf">Business Plan (Presentation)</a>
                        <a href="https://maps.frontenacgis.ca/business%20Plans/2025/Word/LegislativeServices.pdf" class="js-pdf-link sidebar-link" data-pdf-url="https://maps.frontenacgis.ca/business%20Plans/2025/Word/LegislativeServices.pdf">Business Plan (Document)</a>
                        
                        <h3 class="font-bold mt-6 text-frontenac-dark">Project Proposal:</h3>
                        <a href="https://maps.frontenacgis.ca/business%20Plans/2025/PPT/Proposal-EDRMS.pdf" class="js-pdf-link sidebar-link" data-pdf-url="https://maps.frontenacgis.ca/business%20Plans/2025/PPT/Proposal-EDRMS.pdf">Electronic Document Records Management System</a>
                        
                        <h3 class="font-bold mt-6 text-frontenac-dark">Resources:</h3>
                        <a href="https://frontenac.civicweb.net/Portal/" target="_blank" rel="noopener noreferrer" class="sidebar-link">Civic Web (Portal)</a>
                        <a href="https://engagefrontenac.ca/" target="_blank" rel="noopener noreferrer" class="sidebar-link">Engage Frontenac (Website)</a>
                    `
            },
            'Planning and Economic Development': {
                title: "Planning and Economic Development",
                pdfUrl: "https://maps.frontenacgis.ca/business%20Plans/2025/PPT/Planning.pdf",
                sidebarContentHtml: `
                        <h3 class="font-bold mt-1 text-frontenac-dark">Business Plan:</h3>
                        <a href="https://maps.frontenacgis.ca/business%20Plans/2025/PPT/Planning.pdf" class="js-pdf-link sidebar-link" data-pdf-url="https://maps.frontenacgis.ca/business%20Plans/2025/PPT/Planning.pdf">Planning Business Plan (Presentation)</a>
                        <a href="https://maps.frontenacgis.ca/business%20Plans/2025/PPT/EcDev.pdf" class="js-pdf-link sidebar-link" data-pdf-url="https://maps.frontenacgis.ca/business%20Plans/2025/PPT/EcDev.pdf">Economic Development Business Plan (Presentation)</a>
                        <a href="https://maps.frontenacgis.ca/business%20Plans/2025/Word/PlanningEcDev.pdf" class="js-pdf-link sidebar-link" data-pdf-url="https://maps.frontenacgis.ca/business%20Plans/2025/Word/PlanningEcDev.pdf">Business Plan (Document)</a>
                        
                        <h3 class="font-bold mt-6 text-frontenac-dark">Project Proposals:</h3>
                        <a href="https://maps.frontenacgis.ca/business%20Plans/2025/PPT/Proposal-CDO.pdf" class="js-pdf-link sidebar-link" data-pdf-url="https://maps.frontenacgis.ca/business%20Plans/2025/PPT/Proposal-CDO.pdf">Community Development Officer (Phase-In)</a>
                        <a href="https://maps.frontenacgis.ca/business%20Plans/2025/PPT/Proposal-PopulationProjections.pdf" class="js-pdf-link sidebar-link" data-pdf-url="https://maps.frontenacgis.ca/business%20Plans/2025/PPT/Proposal-PopulationProjections.pdf">Population, Housing and Employment Projections</a>
                        
                        <h3 class="font-bold mt-6 text-frontenac-dark">Resources:</h3>
                        <a href="https://www.frontenaccounty.ca/en/business/applications-permits-and-fees.aspx" target="_blank" rel="noopener noreferrer" class="sidebar-link">Planning (Website)</a>
                        <a href="https://www.frontenaccounty.ca/en/business/open-for-business-in-frontenac.aspx" target="_blank" rel="noopener noreferrer" class="sidebar-link">Economic Development (Website)</a>
                        <a href="https://www.visitfrontenac.ca/en/index.aspx" target="_blank" rel="noopener noreferrer" class="sidebar-link">Tourism (Website)</a>
                        <a href="https://engagefrontenac.ca/" target="_blank" rel="noopener noreferrer" class="sidebar-link">Engage Frontenac (Website)</a>
                        <a href="https://openfarms.ca/" target="_blank" rel="noopener noreferrer" class="sidebar-link">Open Farms Days (Website)</a>
                    `
            },
            'K&P Trail': {
                title: "K&P Trail Management",
                pdfUrl: "https://maps.frontenacgis.ca/business%20Plans/2025/PPT/KPTrail.pdf",
                sidebarContentHtml: `
                        <h3 class="font-bold mt-1 text-frontenac-dark">Business Plan:</h3>
                        <a href="https://maps.frontenacgis.ca/business%20Plans/2025/PPT/KPTrail.pdf" class="js-pdf-link sidebar-link" data-pdf-url="https://maps.frontenacgis.ca/business%20Plans/2025/PPT/KPTrail.pdf">Business Plan (Presentation)</a>
                        <a href="https://maps.frontenacgis.ca/business%20Plans/2025/Word/KPTrail.pdf" class="js-pdf-link sidebar-link" data-pdf-url="https://maps.frontenacgis.ca/business%20Plans/2025/Word/KPTrail.pdf">Business Plan (Document)</a>
                        
                        <h3 class="font-bold mt-6 text-frontenac-dark">Resources:</h3>
                        <a href="https://www.frontenaccounty.ca/en/things-to-do/kp-trail.aspx" target="_blank" rel="noopener noreferrer" class="sidebar-link">K&P Trail (Website)</a>
                        <a href="https://ohto.ca/eastern-ontario-rail-trail-loop" target="_blank" rel="noopener noreferrer" class="sidebar-link">Eastern Ontario Rail Trail Loop (Website)</a>
                    `
            }
        };

        // --- DOM Elements ---
        const departmentList = Object.keys(departmentData);
        const fullNavBar = document.getElementById('full-nav');
        const currentTabName = document.getElementById('current-tab-name');
        const prevTabButton = document.getElementById('prev-tab');
        const nextTabButton = document.getElementById('next-tab');
        const sidebarTitle = document.getElementById('sidebar-title');
        const sidebarContent = document.getElementById('sidebar-content');
        const pdfViewer = document.getElementById('pdf-viewer');
        const backButtonContainer = document.getElementById('back-button-container');
        const backButton = document.getElementById('back-button');
        const contentBox = document.getElementById('content-box');
        const hideSidebarBtn = document.getElementById('hide-sidebar-btn');
        const showSidebarBtn = document.getElementById('show-sidebar-btn');


        // --- Helper Function ---

        function isMobileView() {
            return window.innerWidth < MOBILE_BREAKPOINT;
        }


        function toggleMobileSidebar(show) {
            if (isMobileView()) {
                if (show) {
                    contentBox.classList.remove('hidden');
                    showSidebarBtn.classList.add('hidden');
                    contentBox.scrollIntoView({ behavior: 'smooth' });
                } else {
                    contentBox.classList.add('hidden');
                    if (!appState.backButtonVisible) {
                        showSidebarBtn.classList.remove('hidden');
                    }
                }
            }
        }


        // --- Functions ---

        function initializeTabs() {
            departmentList.forEach(deptName => {
                const tab = document.createElement('div');
                tab.className = 'tab px-4 py-2 rounded-lg text-white cursor-pointer transition duration-300 shadow-md bg-frontenac-light hover:bg-frontenac-hover font-semibold whitespace-nowrap';
                tab.textContent = deptName.replace(/ and /g, ' & '); // Use ampersand for shorter tab text
                tab.setAttribute('data-department', deptName);
                tab.addEventListener('click', () => switchDepartment(deptName));
                fullNavBar.appendChild(tab);
            });
        }

        function updatePdfViewer(url, showBack) {
            const viewerUrl = `${url}#view=Fit`;
            pdfViewer.src = viewerUrl;

            if (showBack) {
                backButtonContainer.classList.remove('hidden');
                showSidebarBtn.classList.add('hidden');
            } else {
                backButtonContainer.classList.add('hidden');
                if (isMobileView() && contentBox.classList.contains('hidden')) {
                    showSidebarBtn.classList.remove('hidden');
                } else {
                    showSidebarBtn.classList.add('hidden');
                }
            }
            appState.backButtonVisible = showBack;
        }

        function switchDepartment(departmentName) {
            const data = departmentData[departmentName];

            // 1. Update Application State
            appState.currentDepartment = departmentName;
            appState.mainPdfUrl = data.pdfUrl;
            appState.currentIndex = departmentList.indexOf(departmentName);

            // 2. Update Sidebar
            sidebarTitle.textContent = data.title;
            sidebarContent.innerHTML = data.sidebarContentHtml;

            // 3. Update PDF Viewer (Load Main Plan)
            updatePdfViewer(data.pdfUrl, false); // Hide back button for main view

            // 4. Update Active Tab State (Desktop Tabs)
            document.querySelectorAll('#full-nav .tab').forEach(tab => {
                tab.classList.remove('active', 'bg-frontenac-hover');
                tab.classList.add('bg-frontenac-light');
            });
            const activeTab = document.querySelector(`[data-department="${departmentName}"]`);
            if (activeTab) {
                activeTab.classList.add('active', 'bg-frontenac-hover');
                activeTab.classList.remove('bg-frontenac-light');
            }

            // 5. Update Mobile Tab Name
            currentTabName.textContent = departmentName.replace(/ and /g, ' & ');

            // 6. Mobile View Management: Ensure sidebar is visible on switch
            toggleMobileSidebar(true);

            // 7. Scroll to PDF viewer on mobile for better UX
            if (isMobileView()) {
                pdfViewer.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
        }

        function cycleDepartment(direction) {
            let newIndex = appState.currentIndex + direction;
            if (newIndex < 0) {
                newIndex = departmentList.length - 1; // Wrap around to the end
            } else if (newIndex >= departmentList.length) {
                newIndex = 0; // Wrap around to the start
            }
            switchDepartment(departmentList[newIndex]);
        }

        function handleSidebarLinkClick(event) {
            const target = event.target.closest('.js-pdf-link');
            if (!target) return;

            event.preventDefault();
            const pdfUrl = target.getAttribute('data-pdf-url');
            if (pdfUrl) {
                updatePdfViewer(pdfUrl, true); // Show back button for secondary view

                // If on a mobile device, hide the sidebar to maximize PDF viewer space
                if (isMobileView()) {
                    toggleMobileSidebar(false);
                }

                // Scroll to PDF viewer on mobile for better UX
                pdfViewer.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
        }

        function goBackToMainPlan() {
            if (appState.mainPdfUrl) {
                updatePdfViewer(appState.mainPdfUrl, false); // Hide back button

                // If on a mobile device, show the sidebar again
                if (isMobileView()) {
                    toggleMobileSidebar(true);
                }
            }
        }

        // --- Event Listeners and Initialization ---

        window.onload = () => {
            initializeTabs();
            // Default to the 'Intro' tab
            switchDepartment('Intro');

            // Event delegation for sidebar links
            sidebarContent.addEventListener('click', handleSidebarLinkClick);

            // Event listener for the Back button
            backButton.addEventListener('click', goBackToMainPlan);

            // Event listeners for mobile navigation
            prevTabButton.addEventListener('click', () => cycleDepartment(-1));
            nextTabButton.addEventListener('click', () => cycleDepartment(1));

            // Event listeners for mobile sidebar control
            hideSidebarBtn.addEventListener('click', () => toggleMobileSidebar(false));
            showSidebarBtn.addEventListener('click', () => toggleMobileSidebar(true));
        };

        // Ensure desktop layout reapplies on resize from mobile
        window.addEventListener('resize', () => {
            if (!isMobileView()) {
                contentBox.classList.remove('hidden'); // Always show sidebar on desktop
                showSidebarBtn.classList.add('hidden'); // Hide show button on desktop
            } else {
                // On resize down to mobile, ensure the show button state is correct if sidebar is hidden
                if (contentBox.classList.contains('hidden') && !appState.backButtonVisible) {
                    showSidebarBtn.classList.remove('hidden');
                }
            }
        });
    </script>
</body>

</html>
