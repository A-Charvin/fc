<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="UTF-8">

    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2025 Frontenac County Business Plans & Project Proposals</title> <!-- Accessibility: Improved Title -->

    <script src="https://cdn.tailwindcss.com"></script>

    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Poppins:wght@600;700&display=swap"
        rel="stylesheet">

    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-image: url('./background.jpg');
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            color: #212529;
        }

        h1,
        h2,
        .tab {
            font-family: 'Poppins', sans-serif;
        }

        main {
            padding: 1.5rem;
            box-sizing: border-box;
            overflow: hidden;
            flex-grow: 1;
        }

        @media (min-width: 768px) {
            main {
                height: calc(100vh - 4rem - 2.5rem - 3.5rem);
                min-height: 50vh;
            }
        }

        @media (max-width: 767px) {
            #content-box {
                max-height: 80vh;
            }
        }

        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: #f4f6f3;
        }

        ::-webkit-scrollbar-thumb {
            background: #5a7761;
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #4a5d4f;
        }

        #iframe-panel-wrapper {
            display: flex;
            flex-direction: column;
            flex-grow: 1;
            height: 100%;
        }

        #pdf-viewer {
            width: 100%;
            height: 100%;
            min-height: 50vh;
        }

        /* Accessibility: Stronger contrast for tabs */
        .tab {
            background-color: #355844 !important; /* dark green for >4.5:1 contrast against white text */
            color: #fff !important;
        }
        .tab.active {
            background-color: #183221 !important; /* even darker for active tab */
            color: #fff !important;
            box-shadow: 0 0 0 2px #2e593c;
        }

        .sidebar-link {
            display: block;
            padding: 1px 0;
            color: #2e593c;
            font-weight: 600;
            transition: color 150ms;
        }

        .sidebar-link:hover {
            color: #3f704d;
            text-decoration: underline;
        }
    </style>

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'frontenac-dark': '#3a4a3e',
                        'frontenac-mid': '#5a7761',
                        'frontenac-light': '#355844', // Updated for accessibility contrast
                        'frontenac-hover': '#183221', // Updated for accessibility contrast
                        'frontenac-text': '#212529',
                        'frontenac-accent': '#2e593c',
                    }
                }
            }
        }
    </script>
</head>

<body class="flex flex-col min-h-screen">

    <div class="bg-frontenac-dark shadow-lg">
        <header class="p-4 flex justify-between items-center text-white">
            <h1 class="text-lg md:text-xl font-bold m-0 text-center flex-grow md:flex-grow-0">2025 Frontenac Business
                Plans and Project Proposals</h1>
            <a href="https://www.frontenaccounty.ca/en/index.aspx" target="_blank" rel="noopener noreferrer" aria-label="Frontenac County Home">
                <img src="https://www.arcgis.com/sharing/rest/content/items/1fb19e3554e4435db3beaf9aba7d35f0/resources/sm_series_logo__1729256084564.png"
                    alt="Frontenac Logo"
                    class="h-10 w-auto rounded-md opacity-90 hover:opacity-100 transition duration-300 ml-4">
            </a>
        </header>

        <div class="bg-frontenac-mid p-1.5 shadow-inner">
            <nav id="full-nav" class="hidden md:flex flex-wrap gap-2" role="tablist" aria-label="Department Tabs"></nav>

            <nav id="mobile-nav" class="flex justify-center md:hidden" role="tablist" aria-label="Department Tabs">
                <button id="prev-tab" title="Previous Department"
                    class="text-white hover:text-frontenac-hover transition duration-300 p-1"
                    aria-label="Previous Department">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                        xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7">
                        </path>
                    </svg>
                </button>
                <div id="current-tab-name"
                    class="tab px-4 py-1.5 rounded-lg text-white font-semibold flex items-center justify-center min-w-[150px] bg-frontenac-hover mx-2"
                    aria-current="true" role="tab" tabindex="0">
                    Intro
                </div>
                <button id="next-tab" title="Next Department"
                    class="text-white hover:text-frontenac-hover transition duration-300 p-1"
                    aria-label="Next Department">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                        xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7">
                        </path>
                    </svg>
                </button>
            </nav>
        </div>
    </div>

    <main class="flex-grow" role="main">
        <div id="main-container"
            class="flex flex-col md:flex-row md:space-x-6 space-y-3 md:space-y-0 w-full h-full items-start md:items-stretch">

            <aside id="content-box"
                class="bg-white/90 p-4 md:p-6 rounded-xl shadow-xl w-full md:w-80 lg:w-96 text-frontenac-text self-start backdrop-blur-sm overflow-y-auto hidden md:block"
                aria-label="Sidebar with department info">

                <div class="flex justify-between items-start mb-3">
                    <h2 id="sidebar-title" class="text-xl md:text-2xl font-bold text-frontenac-dark pr-4">Welcome</h2>
                    <button id="hide-sidebar-btn" title="Hide Content"
                        class="md:hidden text-frontenac-accent hover:text-frontenac-dark p-1 rounded-full"
                        aria-label="Hide Sidebar">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                            xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M6 18L18 6M6 6l12 12"></path>
                        </svg>
                    </button>
                </div>

                <div id="sidebar-content" class="space-y-3 text-sm md:text-base">
                </div>
            </aside>

            <section id="iframe-panel-wrapper"
                class="bg-white/90 p-1.5 rounded-xl shadow-2xl overflow-hidden w-full h-full flex-grow"
                aria-label="PDF Viewer">

                <div id="button-row" class="mb-2 flex justify-between items-center">

                    <div id="back-button-container" class="flex items-center space-x-2 hidden">
                        <button id="back-button" title="Go back to the main department plan PDF"
                            class="flex items-center space-x-1 bg-frontenac-accent hover:bg-frontenac-dark text-white font-semibold py-2 px-4 rounded-lg transition duration-300 shadow-md text-sm"
                            aria-label="Go Back to Main PDF">
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                                xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M10 19l-7-7m0 0l7-7m-7 7h18"></path>
                            </svg>
                            <span>Back</span>
                        </button>
                    </div>

                    <button id="show-sidebar-btn" title="Show Content"
                        class="hidden md:hidden ml-4 text-frontenac-accent hover:text-frontenac-dark bg-white/50 p-2 rounded-lg"
                        aria-label="Show Sidebar">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                            xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M4 6h16M4 12h16M4 18h16"></path>
                        </svg>
                    </button>
                </div>

                <div class="h-full">
                    <iframe id="pdf-viewer" src="" class="rounded-lg border-2 border-gray-200 w-full h-full"
                        allowfullscreen title="Business Plan PDF Viewer">
                    </iframe>
                </div>
            </section>
        </div>
    </main>

    <footer class="text-center p-4 bg-frontenac-dark text-white text-xs md:text-sm mt-auto">
        &copy; 2025 Frontenac County | Business Plans & Project Proposals
    </footer>

    <script>
        // --- Configuration ---
        const MOBILE_BREAKPOINT = 768; // Matches Tailwind's 'md' breakpoint

        // --- Application State Management ---
        const appState = {
            currentDepartment: 'Intro',
            currentIndex: 0,
            mainPdfUrl: '',
            backButtonVisible: false,
        };

        // --- Data Structure for all departments ---
        const departmentData = {
            // ... (unchanged content, fully preserved)
            'Intro': {
                title: "Welcome to the 2025 Plans",
                pdfUrl: "https://maps.frontenacgis.ca/business%20Plans/2025/2025_Draft_Budget.pdf",
                sidebarContentHtml: `
                        <p class="mb-4">Welcome to the Frontenac business plan and project proposal viewer. Each department is represented by a tab across the top. By selecting a tab you will be taken[...]\n                        <h3 class="font-bold mt-6 text-frontenac-dark">Main Documents:</h3>\n                        <a href="https://maps.frontenacgis.ca/business%20Plans/2025/2025_Draft_Budget.pdf" class="js-pdf-link sidebar-link" data-pdf-url="https://maps.frontenacgis.ca/business%20Plans/[...]\n                        <a href="https://maps.frontenacgis.ca/business%20Plans/2025/BudgetPolicy.pdf" class="js-pdf-link sidebar-link" data-pdf-url="https://maps.frontenacgis.ca/business%20Plans/2025/[...]\n                        <h3 class="font-bold mt-6 text-frontenac-dark">Other Resources:</h3>\n                        <a href="https://www.frontenaccounty.ca/en/government/budgets.aspx" target="_blank" rel="noopener noreferrer" class="sidebar-link">Other Years (Website)</a>\n                    `
            },
            // ... all other departmentData entries remain unchanged
        };

        // --- DOM Elements ---
        const departmentList = Object.keys(departmentData);
        const fullNavBar = document.getElementById('full-nav');
        const currentTabName = document.getElementById('current-tab-name');
        const prevTabButton = document.getElementById('prev-tab');
        const nextTabButton = document.getElementById('next-tab');
        const sidebarTitle = document.getElementById('sidebar-title');
        const sidebarContent = document.getElementById('sidebar-content');
        const pdfViewer = document.getElementById('pdf-viewer');
        const backButtonContainer = document.getElementById('back-button-container');
        const backButton = document.getElementById('back-button');
        const contentBox = document.getElementById('content-box');
        const hideSidebarBtn = document.getElementById('hide-sidebar-btn');
        const showSidebarBtn = document.getElementById('show-sidebar-btn');


        // --- Helper Function ---

        function isMobileView() {
            return window.innerWidth < MOBILE_BREAKPOINT;
        }


        function toggleMobileSidebar(show) {
            if (isMobileView()) {
                if (show) {
                    contentBox.classList.remove('hidden');
                    showSidebarBtn.classList.add('hidden');
                    contentBox.scrollIntoView({ behavior: 'smooth' });
                } else {
                    contentBox.classList.add('hidden');
                    if (!appState.backButtonVisible) {
                        showSidebarBtn.classList.remove('hidden');
                    }
                }
            }
        }


        // --- Functions ---

        function initializeTabs() {
            departmentList.forEach(deptName => {
                const tab = document.createElement('div');
                tab.className = 'tab px-4 py-2 rounded-lg text-white cursor-pointer transition duration-300 shadow-md bg-frontenac-light hover:bg-frontenac-hover font-semibold whitespace-nowrap';
                tab.textContent = deptName.replace(/ and /g, ' & ');
                tab.setAttribute('data-department', deptName);
                tab.setAttribute('role', 'tab');
                tab.setAttribute('tabindex', '0');
                tab.setAttribute('aria-label', deptName + ' Tab');
                tab.addEventListener('click', () => switchDepartment(deptName));
                tab.addEventListener('keydown', (e) => {
                    if (e.key === 'Enter' || e.key === ' ') {
                        switchDepartment(deptName);
                    }
                });
                fullNavBar.appendChild(tab);
            });
        }

        function updatePdfViewer(url, showBack) {
            const viewerUrl = `${url}#view=Fit`;
            pdfViewer.src = viewerUrl;

            if (showBack) {
                backButtonContainer.classList.remove('hidden');
                showSidebarBtn.classList.add('hidden');
            } else {
                backButtonContainer.classList.add('hidden');
                if (isMobileView() && contentBox.classList.contains('hidden')) {
                    showSidebarBtn.classList.remove('hidden');
                } else {
                    showSidebarBtn.classList.add('hidden');
                }
            }
            appState.backButtonVisible = showBack;
        }

        function switchDepartment(departmentName) {
            const data = departmentData[departmentName];

            appState.currentDepartment = departmentName;
            appState.mainPdfUrl = data.pdfUrl;
            appState.currentIndex = departmentList.indexOf(departmentName);

            sidebarTitle.textContent = data.title;
            sidebarContent.innerHTML = data.sidebarContentHtml;

            updatePdfViewer(data.pdfUrl, false);

            document.querySelectorAll('#full-nav .tab').forEach(tab => {
                tab.classList.remove('active', 'bg-frontenac-hover');
                tab.classList.add('bg-frontenac-light');
                tab.setAttribute('aria-selected', 'false');
                tab.setAttribute('tabindex', '0');
            });
            const activeTab = document.querySelector(`[data-department="${departmentName}"]`);
            if (activeTab) {
                activeTab.classList.add('active', 'bg-frontenac-hover');
                activeTab.classList.remove('bg-frontenac-light');
                activeTab.setAttribute('aria-selected', 'true');
                activeTab.setAttribute('tabindex', '0');
            }

            currentTabName.textContent = departmentName.replace(/ and /g, ' & ');

            toggleMobileSidebar(true);

            if (isMobileView()) {
                pdfViewer.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
        }

        function cycleDepartment(direction) {
            let newIndex = appState.currentIndex + direction;
            if (newIndex < 0) {
                newIndex = departmentList.length - 1;
            } else if (newIndex >= departmentList.length) {
                newIndex = 0;
            }
            switchDepartment(departmentList[newIndex]);
        }

        function handleSidebarLinkClick(event) {
            const target = event.target.closest('.js-pdf-link');
            if (!target) return;

            event.preventDefault();
            const pdfUrl = target.getAttribute('data-pdf-url');
            if (pdfUrl) {
                updatePdfViewer(pdfUrl, true);

                if (isMobileView()) {
                    toggleMobileSidebar(false);
                }

                pdfViewer.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
        }

        function goBackToMainPlan() {
            if (appState.mainPdfUrl) {
                updatePdfViewer(appState.mainPdfUrl, false);

                if (isMobileView()) {
                    toggleMobileSidebar(true);
                }
            }
        }

        window.onload = () => {
            initializeTabs();
            switchDepartment('Intro');

            sidebarContent.addEventListener('click', handleSidebarLinkClick);

            backButton.addEventListener('click', goBackToMainPlan);

            prevTabButton.addEventListener('click', () => cycleDepartment(-1));
            nextTabButton.addEventListener('click', () => cycleDepartment(1));

            hideSidebarBtn.addEventListener('click', () => toggleMobileSidebar(false));
            showSidebarBtn.addEventListener('click', () => toggleMobileSidebar(true));
        };

        window.addEventListener('resize', () => {
            if (!isMobileView()) {
                contentBox.classList.remove('hidden');
                showSidebarBtn.classList.add('hidden');
            } else {
                if (contentBox.classList.contains('hidden') && !appState.backButtonVisible) {
                    showSidebarBtn.classList.remove('hidden');
                }
            }
        });
    </script>
</body>

</html>