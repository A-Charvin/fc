<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2025 Frontenac Business Plans and Project Proposals</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Poppins:wght@600;700&display=swap"
        rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-image: url('./background.jpg');
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            color: #1a1a1a;
        }

        h1,
        h2,
        .tab {
            font-family: 'Poppins', sans-serif;
        }

        main {
            padding: 1.5rem;
            box-sizing: border-box;
            overflow: hidden;
            flex-grow: 1;
        }

        @media (min-width: 768px) {
            main {
                height: calc(100vh - 4rem - 2.5rem - 3.5rem);
                min-height: 50vh;
            }
        }

        @media (max-width: 767px) {
            #content-box {
                max-height: 80vh;
            }
        }

        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: #f4f6f3;
        }

        ::-webkit-scrollbar-thumb {
            background: #4a5d4f;
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #3a4d3f;
        }

        #iframe-panel-wrapper {
            display: flex;
            flex-direction: column;
            flex-grow: 1;
            height: 100%;
        }

        #pdf-viewer {
            width: 100%;
            height: 100%;
            min-height: 50vh;
        }

        .tab.active {
            background-color: #2d5a3a;
            box-shadow: 0 0 0 3px #234529;
        }

        .tab:focus {
            outline: 3px solid #234529;
            outline-offset: 2px;
        }

        .sidebar-link {
            display: block;
            padding: 1px 0;
            color: #234529;
            font-weight: 600;
            transition: color 150ms;
            text-decoration: underline;
        }

        .sidebar-link:hover,
        .sidebar-link:focus {
            color: #2d5a3a;
            outline: 2px solid #234529;
            outline-offset: 2px;
        }

        button:focus {
            outline: 3px solid #234529;
            outline-offset: 2px;
        }

        .skip-link {
            position: absolute;
            top: -40px;
            left: 0;
            background: #234529;
            color: white;
            padding: 8px;
            text-decoration: none;
            z-index: 100;
        }

        .skip-link:focus {
            top: 0;
        }
    </style>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'frontenac-dark': '#243127',
                        'frontenac-mid': '#425347',
                        'frontenac-light': '#4d5d51',
                        'frontenac-hover': '#637768',
                        'frontenac-text': '#272727',
                        'frontenac-accent': '#234529',
                    }
                }
            }
        }
    </script>
</head>

<body class="flex flex-col min-h-screen">
    <a href="#main-content" class="skip-link">Skip to main content</a>

    <div class="bg-frontenac-dark shadow-lg">
        <header class="p-4 flex justify-between items-center text-white">
            <h1 class="text-lg md:text-xl font-bold m-0 text-center flex-grow md:flex-grow-0">2025 Frontenac Business
                Plans and Project Proposals</h1>
            <a href="https://www.frontenaccounty.ca/en/index.aspx" target="_blank" rel="noopener noreferrer"
                aria-label="Visit Frontenac County website">
                <img src="https://www.arcgis.com/sharing/rest/content/items/1fb19e3554e4435db3beaf9aba7d35f0/resources/sm_series_logo__1729256084564.png"
                    alt="Frontenac County Logo"
                    class="h-10 w-auto rounded-md opacity-90 hover:opacity-100 transition duration-300 ml-4">
            </a>
        </header>

        <nav class="bg-frontenac-mid p-1.5 shadow-inner" aria-label="Department navigation">
            <div id="full-nav" class="hidden md:flex flex-wrap gap-2" role="tablist"></div>

            <div id="mobile-nav" class="flex justify-center md:hidden">
                <button id="prev-tab" aria-label="Previous Department"
                    class="text-white hover:text-frontenac-hover transition duration-300 p-1">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7">
                        </path>
                    </svg>
                </button>
                <div id="current-tab-name"
                    class="tab px-4 py-1.5 rounded-lg text-white font-semibold flex items-center justify-center min-w-[150px] bg-frontenac-hover mx-2"
                    role="status" aria-live="polite">Intro</div>
                <button id="next-tab" aria-label="Next Department"
                    class="text-white hover:text-frontenac-hover transition duration-300 p-1">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                    </svg>
                </button>
            </div>
        </nav>
    </div>

    <main class="flex-grow" id="main-content">
        <div id="main-container"
            class="flex flex-col md:flex-row md:space-x-6 space-y-3 md:space-y-0 w-full h-full items-start md:items-stretch">

            <aside id="content-box"
                class="bg-white/90 p-4 md:p-6 rounded-xl shadow-xl w-full md:w-80 lg:w-96 text-frontenac-text self-start backdrop-blur-sm overflow-y-auto hidden md:block"
                aria-labelledby="sidebar-title">
                <div class="flex justify-between items-start mb-3">
                    <h2 id="sidebar-title" class="text-xl md:text-2xl font-bold text-frontenac-dark pr-4">Welcome</h2>
                    <button id="hide-sidebar-btn" aria-label="Hide sidebar content"
                        class="md:hidden text-frontenac-accent hover:text-frontenac-dark p-1 rounded-full">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M6 18L18 6M6 6l12 12"></path>
                        </svg>
                    </button>
                </div>
                <div id="sidebar-content" class="space-y-3 text-sm md:text-base"></div>
            </aside>

            <div id="iframe-panel-wrapper"
                class="bg-white/90 p-1.5 rounded-xl shadow-2xl overflow-hidden w-full h-full flex-grow">
                <div id="button-row" class="mb-2 flex justify-between items-center">
                    <div id="back-button-container" class="flex items-center space-x-2 hidden">
                        <button id="back-button" aria-label="Go back to the main department plan PDF"
                            class="flex items-center space-x-1 bg-frontenac-accent hover:bg-frontenac-dark text-white font-semibold py-2 px-4 rounded-lg transition duration-300 shadow-md text-sm">
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                                aria-hidden="true">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M10 19l-7-7m0 0l7-7m-7 7h18"></path>
                            </svg>
                            <span>Back</span>
                        </button>
                    </div>
                    <button id="show-sidebar-btn" aria-label="Show sidebar content"
                        class="hidden md:hidden ml-4 text-frontenac-accent hover:text-frontenac-dark bg-white/50 p-2 rounded-lg">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M4 6h16M4 12h16M4 18h16"></path>
                        </svg>
                    </button>
                </div>
                <div class="h-full">
                    <iframe id="pdf-viewer" src="about:blank" title="Business plan and project proposal document viewer"
                        class="rounded-lg border-2 border-gray-200 w-full h-full" allowfullscreen></iframe>
                </div>
            </div>
        </div>
    </main>

    <footer class="text-center p-4 bg-frontenac-dark text-white text-xs md:text-sm mt-auto">
        &copy; 2025 Frontenac County | Business Plans &amp; Project Proposals
    </footer>

    <script>
        const MOBILE_BREAKPOINT = 768;
        const appState = {
            currentDepartment: 'Intro',
            currentIndex: 0,
            mainPdfUrl: '',
            backButtonVisible: false,
        };

        // --- Data Structure for all departments ---
        const departmentData = {
            'Intro': {
                title: "Welcome to the 2025 Plans",
                pdfUrl: "https://maps.frontenacgis.ca/business%20Plans/2025/2025_Draft_Budget.pdf",
                sidebarContentHtml: `
                        <p class="mb-4">Welcome to the Frontenac business plan and project proposal viewer. Each department is represented by a tab across the top. By selecting a tab you will be taken to the business plan associated with that department. There are also additional related resources and documents on each tab that can be viewed by clicking the links in the left menu.</p>
                        
                        <h3 class="font-bold mt-6 text-frontenac-dark">Main Documents:</h3>
                        <a href="https://maps.frontenacgis.ca/business%20Plans/2025/2025_Draft_Budget.pdf" class="js-pdf-link sidebar-link" data-pdf-url="https://maps.frontenacgis.ca/business%20Plans/2025/2025_Draft_Budget.pdf">2025 Draft Budget</a>
                        <a href="https://maps.frontenacgis.ca/business%20Plans/2025/BudgetPolicy.pdf" class="js-pdf-link sidebar-link" data-pdf-url="https://maps.frontenacgis.ca/business%20Plans/2025/BudgetPolicy.pdf">Budget Policy</a>
                        
                        <h3 class="font-bold mt-6 text-frontenac-dark">Other Resources:</h3>
                        <a href="https://www.frontenaccounty.ca/en/government/budgets.aspx" target="_blank" rel="noopener noreferrer" class="sidebar-link">Other Years (Website)</a>
                    `
            },
            'GIS': {
                title: "Geographic Information Systems (GIS)",
                pdfUrl: "https://maps.frontenacgis.ca/business%20Plans/2025/PPT/GIS.pdf",
                sidebarContentHtml: `
                        <h3 class="font-bold mt-1 text-frontenac-dark">Business Plan:</h3>
                        <a href="https://maps.frontenacgis.ca/business%20Plans/2025/PPT/GIS.pdf" class="js-pdf-link sidebar-link" data-pdf-url="https://maps.frontenacgis.ca/business%20Plans/2025/PPT/GIS.pdf">Business Plan (Presentation)</a>
                        <a href="https://maps.frontenacgis.ca/business%20Plans/2025/Word/GIS.pdf" class="js-pdf-link sidebar-link" data-pdf-url="https://maps.frontenacgis.ca/business%20Plans/2025/Word/GIS.pdf">Business Plan (Document)</a>
                        
                        <h3 class="font-bold mt-6 text-frontenac-dark">Resources:</h3>
                        <a href="https://www.frontenacmaps.ca/" target="_blank" rel="noopener noreferrer" class="sidebar-link">Frontenac Maps (GeoHub)</a>
                        <a href="https://www.frontenaccounty.ca/en/living/maps-and-gis.aspx" target="_blank" rel="noopener noreferrer" class="sidebar-link">Maps and GIS (Website)</a>
                    `
            },
            'Fairmount Home': {
                title: "Fairmount Home",
                pdfUrl: "https://maps.frontenacgis.ca/business%20Plans/2025/PPT/FMT.pdf",
                sidebarContentHtml: `
                        <h3 class="font-bold mt-1 text-frontenac-dark">Business Plan:</h3>
                        <a href="https://maps.frontenacgis.ca/business%20Plans/2025/PPT/FMT.pdf" class="js-pdf-link sidebar-link" data-pdf-url="https://maps.frontenacgis.ca/business%20Plans/2025/PPT/FMT.pdf">Business Plan (Presentation)</a>
                        <a href="https://maps.frontenacgis.ca/business%20Plans/2025/Word/FMT.pdf" class="js-pdf-link sidebar-link" data-pdf-url="https://maps.frontenacgis.ca/business%20Plans/2025/Word/FMT.pdf">Business Plan (Document)</a>
                        
                        <h3 class="font-bold mt-6 text-frontenac-dark">Project Proposal:</h3>
                        <a href="https://maps.frontenacgis.ca/business%20Plans/2025/PPT/Proposal-OccupationalTherapist.pdf" class="js-pdf-link sidebar-link" data-pdf-url="https://maps.frontenacgis.ca/business%20Plans/2025/PPT/Proposal-OccupationalTherapist.pdf">Occupational Therapist (Full-Time)</a>
                        
                        <h3 class="font-bold mt-6 text-frontenac-dark">Resources:</h3>
                        <a href="https://www.frontenaccounty.ca/en/fairmounthome/index.aspx" target="_blank" rel="noopener noreferrer" class="sidebar-link">Fairmount Home (Website)</a>
                    `
            },
            'Financial Services': {
                title: "Financial Services",
                pdfUrl: "https://maps.frontenacgis.ca/business%20Plans/2025/PPT/Finance.pdf",
                sidebarContentHtml: `
                        <h3 class="font-bold mt-1 text-frontenac-dark">Business Plan:</h3>
                        <a href="https://maps.frontenacgis.ca/business%20Plans/2025/PPT/Finance.pdf" class="js-pdf-link sidebar-link" data-pdf-url="https://maps.frontenacgis.ca/business%20Plans/2025/PPT/Finance.pdf">Business Plan (Presentation)</a>
                        <a href="https://maps.frontenacgis.ca/business%20Plans/2025/Word/Finance.pdf" class="js-pdf-link sidebar-link" data-pdf-url="https://maps.frontenacgis.ca/business%20Plans/2025/Word/Finance.pdf">Business Plan (Document)</a>
                        
                        <h3 class="font-bold mt-6 text-frontenac-dark">Resources:</h3>
                        <a href="https://www.frontenaccounty.ca/en/government/finances-and-budget.aspx" target="_blank" rel="noopener noreferrer" class="sidebar-link">Finance and Budgets (Website)</a>
                    `
            },
            'Information Services': {
                title: "Information Services",
                pdfUrl: "https://maps.frontenacgis.ca/business%20Plans/2025/PPT/FMIS.pdf",
                sidebarContentHtml: `
                        <h3 class="font-bold mt-1 text-frontenac-dark">Business Plan:</h3>
                        <a href="https://maps.frontenacgis.ca/business%20Plans/2025/PPT/FMIS.pdf" class="js-pdf-link sidebar-link" data-pdf-url="https://maps.frontenacgis.ca/business%20Plans/2025/PPT/FMIS.pdf">Business Plan (Presentation)</a>
                        <a href="https://maps.frontenacgis.ca/business%20Plans/2025/Word/FMIS.pdf" class="js-pdf-link sidebar-link" data-pdf-url="https://maps.frontenacgis.ca/business%20Plans/2025/Word/FMIS.pdf">Business Plan (Document)</a>
                    `
            },
            'Frontenac Paramedics': {
                title: "Frontenac Paramedic Services",
                pdfUrl: "https://maps.frontenacgis.ca/business%20Plans/2025/PPT/FPS.pdf",
                sidebarContentHtml: `
                        <h3 class="font-bold mt-1 text-frontenac-dark">Business Plan:</h3>
                        <a href="https://maps.frontenacgis.ca/business%20Plans/2025/PPT/FPS.pdf" class="js-pdf-link sidebar-link" data-pdf-url="https://maps.frontenacgis.ca/business%20Plans/2025/PPT/FPS.pdf">Business Plan (Presentation)</a>
                        <a href="https://maps.frontenacgis.ca/business%20Plans/2025/Word/FPS.pdf" class="js-pdf-link sidebar-link" data-pdf-url="https://maps.frontenacgis.ca/business%20Plans/2025/Word/FPS.pdf">Business Plan (Document)</a>
                        
                        <h3 class="font-bold mt-6 text-frontenac-dark">Project Proposals:</h3>
                        <a href="https://maps.frontenacgis.ca/business%20Plans/2025/PPT/FPS-EPRProposal.pdf" class="js-pdf-link sidebar-link" data-pdf-url="https://maps.frontenacgis.ca/business%20Plans/2025/PPT/FPS-EPRProposal.pdf">Enhanced Paramedic Resource</a>
                        <a href="https://maps.frontenacgis.ca/business%20Plans/2025/PPT/FPS-SPSProposal.pdf" class="js-pdf-link sidebar-link" data-pdf-url="https://maps.frontenacgis.ca/business%20Plans/2025/PPT/FPS-SPSProposal.pdf">Superintendent of Performance Standards, Training</a>
                        
                        <h3 class="font-bold mt-6 text-frontenac-dark">Resources:</h3>
                        <a href="https://www.frontenaccounty.ca/en/paramedics/index.aspx" target="_blank" rel="noopener noreferrer" class="sidebar-link">Frontenac Paramedic Services (Website)</a>
                        <a href="https://frontenac.maps.arcgis.com/apps/MapSeries/index.html?appid=1fb19e3554e4435db3beaf9aba7d35f0#" target="_blank" rel="noopener noreferrer" class="sidebar-link">Paramedic Stations (Map)</a>
                        <a href="https://maps.frontenacgis.ca/business%20Plans/2025/ORH_Study.pdf" class="js-pdf-link sidebar-link" data-pdf-url="https://maps.frontenacgis.ca/business%20Plans/2025/ORH_Study.pdf">ORH - 10-Year HR and Facilities Master Plan</a>
                        <a href="https://maps.frontenacgis.ca/business%20Plans/2025/EOWC_Study.pdf" class="js-pdf-link sidebar-link" data-pdf-url="https://maps.frontenacgis.ca/business%20Plans/2025/EOWC_Study.pdf">EOWC - Review of E Ontario Paramedic Services</a>
                        <a href="https://maps.frontenacgis.ca/business%20Plans/2025/EOWC_Paramedic_Services_Partial_Refresh.pdf" class="js-pdf-link sidebar-link" data-pdf-url="https://maps.frontenacgis.ca/business%20Plans/2025/EOWC_Paramedic_Services_Partial_Refresh.pdf">EOWC - Paramedic Services Partial Refresh</a>
                    `
            },
            'Human Resources': {
                title: "Human Resources (HR)",
                pdfUrl: "https://maps.frontenacgis.ca/business%20Plans/2025/PPT/HR.pdf",
                sidebarContentHtml: `
                        <h3 class="font-bold mt-1 text-frontenac-dark">Business Plan:</h3>
                        <a href="https://maps.frontenacgis.ca/business%20Plans/2025/PPT/HR.pdf" class="js-pdf-link sidebar-link" data-pdf-url="https://maps.frontenacgis.ca/business%20Plans/2025/PPT/HR.pdf">Business Plan (Presentation)</a>
                        <a href="https://maps.frontenacgis.ca/business%20Plans/2025/Word/HR.pdf" class="js-pdf-link sidebar-link" data-pdf-url="https://maps.frontenacgis.ca/business%20Plans/2025/Word/HR.pdf">Business Plan (Document)</a>
                        
                        <h3 class="font-bold mt-6 text-frontenac-dark">Resources:</h3>
                        <a href="https://www.frontenaccounty.ca/en/government/careers.aspx" target="_blank" rel="noopener noreferrer" class="sidebar-link">Careers (Website)</a>
                    `
            },
            'Legislative Services': {
                title: "Legislative Services",
                pdfUrl: "https://maps.frontenacgis.ca/business%20Plans/2025/PPT/LegislativeServices.pdf",
                sidebarContentHtml: `
                        <h3 class="font-bold mt-1 text-frontenac-dark">Business Plan:</h3>
                        <a href="https://maps.frontenacgis.ca/business%20Plans/2025/PPT/LegislativeServices.pdf" class="js-pdf-link sidebar-link" data-pdf-url="https://maps.frontenacgis.ca/business%20Plans/2025/PPT/LegislativeServices.pdf">Business Plan (Presentation)</a>
                        <a href="https://maps.frontenacgis.ca/business%20Plans/2025/Word/LegislativeServices.pdf" class="js-pdf-link sidebar-link" data-pdf-url="https://maps.frontenacgis.ca/business%20Plans/2025/Word/LegislativeServices.pdf">Business Plan (Document)</a>
                        
                        <h3 class="font-bold mt-6 text-frontenac-dark">Project Proposal:</h3>
                        <a href="https://maps.frontenacgis.ca/business%20Plans/2025/PPT/Proposal-EDRMS.pdf" class="js-pdf-link sidebar-link" data-pdf-url="https://maps.frontenacgis.ca/business%20Plans/2025/PPT/Proposal-EDRMS.pdf">Electronic Document Records Management System</a>
                        
                        <h3 class="font-bold mt-6 text-frontenac-dark">Resources:</h3>
                        <a href="https://frontenac.civicweb.net/Portal/" target="_blank" rel="noopener noreferrer" class="sidebar-link">Civic Web (Portal)</a>
                        <a href="https://engagefrontenac.ca/" target="_blank" rel="noopener noreferrer" class="sidebar-link">Engage Frontenac (Website)</a>
                    `
            },
            'Planning and Economic Development': {
                title: "Planning and Economic Development",
                pdfUrl: "https://maps.frontenacgis.ca/business%20Plans/2025/PPT/Planning.pdf",
                sidebarContentHtml: `
                        <h3 class="font-bold mt-1 text-frontenac-dark">Business Plan:</h3>
                        <a href="https://maps.frontenacgis.ca/business%20Plans/2025/PPT/Planning.pdf" class="js-pdf-link sidebar-link" data-pdf-url="https://maps.frontenacgis.ca/business%20Plans/2025/PPT/Planning.pdf">Planning Business Plan (Presentation)</a>
                        <a href="https://maps.frontenacgis.ca/business%20Plans/2025/PPT/EcDev.pdf" class="js-pdf-link sidebar-link" data-pdf-url="https://maps.frontenacgis.ca/business%20Plans/2025/PPT/EcDev.pdf">Economic Development Business Plan (Presentation)</a>
                        <a href="https://maps.frontenacgis.ca/business%20Plans/2025/Word/PlanningEcDev.pdf" class="js-pdf-link sidebar-link" data-pdf-url="https://maps.frontenacgis.ca/business%20Plans/2025/Word/PlanningEcDev.pdf">Business Plan (Document)</a>
                        
                        <h3 class="font-bold mt-6 text-frontenac-dark">Project Proposals:</h3>
                        <a href="https://maps.frontenacgis.ca/business%20Plans/2025/PPT/Proposal-CDO.pdf" class="js-pdf-link sidebar-link" data-pdf-url="https://maps.frontenacgis.ca/business%20Plans/2025/PPT/Proposal-CDO.pdf">Community Development Officer (Phase-In)</a>
                        <a href="https://maps.frontenacgis.ca/business%20Plans/2025/PPT/Proposal-PopulationProjections.pdf" class="js-pdf-link sidebar-link" data-pdf-url="https://maps.frontenacgis.ca/business%20Plans/2025/PPT/Proposal-PopulationProjections.pdf">Population, Housing and Employment Projections</a>
                        
                        <h3 class="font-bold mt-6 text-frontenac-dark">Resources:</h3>
                        <a href="https://www.frontenaccounty.ca/en/business/applications-permits-and-fees.aspx" target="_blank" rel="noopener noreferrer" class="sidebar-link">Planning (Website)</a>
                        <a href="https://www.frontenaccounty.ca/en/business/open-for-business-in-frontenac.aspx" target="_blank" rel="noopener noreferrer" class="sidebar-link">Economic Development (Website)</a>
                        <a href="https://www.visitfrontenac.ca/en/index.aspx" target="_blank" rel="noopener noreferrer" class="sidebar-link">Tourism (Website)</a>
                        <a href="https://engagefrontenac.ca/" target="_blank" rel="noopener noreferrer" class="sidebar-link">Engage Frontenac (Website)</a>
                        <a href="https://openfarms.ca/" target="_blank" rel="noopener noreferrer" class="sidebar-link">Open Farms Days (Website)</a>
                    `
            },
            'K&P Trail': {
                title: "K&P Trail Management",
                pdfUrl: "https://maps.frontenacgis.ca/business%20Plans/2025/PPT/KPTrail.pdf",
                sidebarContentHtml: `
                        <h3 class="font-bold mt-1 text-frontenac-dark">Business Plan:</h3>
                        <a href="https://maps.frontenacgis.ca/business%20Plans/2025/PPT/KPTrail.pdf" class="js-pdf-link sidebar-link" data-pdf-url="https://maps.frontenacgis.ca/business%20Plans/2025/PPT/KPTrail.pdf">Business Plan (Presentation)</a>
                        <a href="https://maps.frontenacgis.ca/business%20Plans/2025/Word/KPTrail.pdf" class="js-pdf-link sidebar-link" data-pdf-url="https://maps.frontenacgis.ca/business%20Plans/2025/Word/KPTrail.pdf">Business Plan (Document)</a>
                        
                        <h3 class="font-bold mt-6 text-frontenac-dark">Resources:</h3>
                        <a href="https://www.frontenaccounty.ca/en/things-to-do/kp-trail.aspx" target="_blank" rel="noopener noreferrer" class="sidebar-link">K&P Trail (Website)</a>
                        <a href="https://ohto.ca/eastern-ontario-rail-trail-loop" target="_blank" rel="noopener noreferrer" class="sidebar-link">Eastern Ontario Rail Trail Loop (Website)</a>
                    `
            }
        };

        // --- DOM Elements ---
        const departmentList = Object.keys(departmentData);
        const fullNavBar = document.getElementById('full-nav');
        const currentTabName = document.getElementById('current-tab-name');
        const prevTabButton = document.getElementById('prev-tab');
        const nextTabButton = document.getElementById('next-tab');
        const sidebarTitle = document.getElementById('sidebar-title');
        const sidebarContent = document.getElementById('sidebar-content');
        const pdfViewer = document.getElementById('pdf-viewer');
        const backButtonContainer = document.getElementById('back-button-container');
        const backButton = document.getElementById('back-button');
        const contentBox = document.getElementById('content-box');
        const hideSidebarBtn = document.getElementById('hide-sidebar-btn');
        const showSidebarBtn = document.getElementById('show-sidebar-btn');

        function isMobileView() {
            return window.innerWidth < MOBILE_BREAKPOINT;
        }

        function toggleMobileSidebar(show) {
            if (isMobileView()) {
                if (show) {
                    contentBox.classList.remove('hidden');
                    showSidebarBtn.classList.add('hidden');
                    contentBox.scrollIntoView({ behavior: 'smooth' });
                } else {
                    contentBox.classList.add('hidden');
                    if (!appState.backButtonVisible) {
                        showSidebarBtn.classList.remove('hidden');
                    }
                }
            }
        }

        function initializeTabs() {
            departmentList.forEach((deptName, index) => {
                const tab = document.createElement('button');
                tab.className = 'tab px-4 py-2 rounded-lg text-white cursor-pointer transition duration-300 shadow-md bg-frontenac-light hover:bg-frontenac-hover font-semibold whitespace-nowrap';
                tab.textContent = deptName.replace(/ and /g, ' & ');
                tab.setAttribute('role', 'tab');
                tab.setAttribute('aria-selected', 'false');
                tab.setAttribute('aria-controls', 'pdf-viewer');
                tab.setAttribute('id', `tab-${index}`);
                tab.setAttribute('data-department', deptName);
                tab.addEventListener('click', () => switchDepartment(deptName));
                tab.addEventListener('keydown', handleTabKeydown);
                fullNavBar.appendChild(tab);
            });
        }

        function handleTabKeydown(e) {
            const tabs = Array.from(fullNavBar.querySelectorAll('.tab'));
            const currentIndex = tabs.indexOf(e.target);

            if (e.key === 'ArrowLeft') {
                e.preventDefault();
                const prevIndex = currentIndex > 0 ? currentIndex - 1 : tabs.length - 1;
                tabs[prevIndex].focus();
            } else if (e.key === 'ArrowRight') {
                e.preventDefault();
                const nextIndex = currentIndex < tabs.length - 1 ? currentIndex + 1 : 0;
                tabs[nextIndex].focus();
            } else if (e.key === 'Home') {
                e.preventDefault();
                tabs[0].focus();
            } else if (e.key === 'End') {
                e.preventDefault();
                tabs[tabs.length - 1].focus();
            }
        }

        function updatePdfViewer(url, showBack) {
            const viewerUrl = `${url}#view=Fit`;
            pdfViewer.src = viewerUrl;
            pdfViewer.setAttribute('title', `Viewing: ${departmentData[appState.currentDepartment].title}`);

            if (showBack) {
                backButtonContainer.classList.remove('hidden');
                showSidebarBtn.classList.add('hidden');
            } else {
                backButtonContainer.classList.add('hidden');
                if (isMobileView() && contentBox.classList.contains('hidden')) {
                    showSidebarBtn.classList.remove('hidden');
                } else {
                    showSidebarBtn.classList.add('hidden');
                }
            }
            appState.backButtonVisible = showBack;
        }

        function switchDepartment(departmentName) {
            const data = departmentData[departmentName];
            appState.currentDepartment = departmentName;
            appState.mainPdfUrl = data.pdfUrl;
            appState.currentIndex = departmentList.indexOf(departmentName);

            sidebarTitle.textContent = data.title;
            sidebarContent.innerHTML = data.sidebarContentHtml;
            updatePdfViewer(data.pdfUrl, false);

            document.querySelectorAll('#full-nav .tab').forEach(tab => {
                const isActive = tab.getAttribute('data-department') === departmentName;
                tab.classList.toggle('active', isActive);
                tab.classList.toggle('bg-frontenac-hover', isActive);
                tab.classList.toggle('bg-frontenac-light', !isActive);
                tab.setAttribute('aria-selected', isActive);
                tab.setAttribute('tabindex', isActive ? '0' : '-1');
            });

            currentTabName.textContent = departmentName.replace(/ and /g, ' & ');
            toggleMobileSidebar(true);

            if (isMobileView()) {
                pdfViewer.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
        }

        function cycleDepartment(direction) {
            let newIndex = appState.currentIndex + direction;
            if (newIndex < 0) {
                newIndex = departmentList.length - 1;
            } else if (newIndex >= departmentList.length) {
                newIndex = 0;
            }
            switchDepartment(departmentList[newIndex]);
        }

        function handleSidebarLinkClick(event) {
            const target = event.target.closest('.js-pdf-link');
            if (!target) return;

            event.preventDefault();
            const pdfUrl = target.getAttribute('data-pdf-url');
            if (pdfUrl) {
                updatePdfViewer(pdfUrl, true);
                if (isMobileView()) {
                    toggleMobileSidebar(false);
                }
                pdfViewer.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
        }

        function goBackToMainPlan() {
            if (appState.mainPdfUrl) {
                updatePdfViewer(appState.mainPdfUrl, false);
                if (isMobileView()) {
                    toggleMobileSidebar(true);
                }
            }
        }

        window.onload = () => {
            initializeTabs();
            switchDepartment('Intro');
            sidebarContent.addEventListener('click', handleSidebarLinkClick);
            backButton.addEventListener('click', goBackToMainPlan);
            prevTabButton.addEventListener('click', () => cycleDepartment(-1));
            nextTabButton.addEventListener('click', () => cycleDepartment(1));
            hideSidebarBtn.addEventListener('click', () => toggleMobileSidebar(false));
            showSidebarBtn.addEventListener('click', () => toggleMobileSidebar(true));
        };

        window.addEventListener('resize', () => {
            if (!isMobileView()) {
                contentBox.classList.remove('hidden');
                showSidebarBtn.classList.add('hidden');
            } else {
                if (contentBox.classList.contains('hidden') && !appState.backButtonVisible) {
                    showSidebarBtn.classList.remove('hidden');
                }
            }
        });
    </script>
</body>

</html>
